# ChIP_downstream_analysis


This workflow accepts sorted and indexed bam files from ACT-seq or ChIP-seq experiments and generates signal tracks in bigwig format with deeptools, calls peaks and annotates these. It assumes, that the experiment was conducted without mock/input data. In detail, a HOMER tag directory including quality control files is generated and afterwards peaks are called with HOMER default settings if not changed. User needs to specify in parameter style if the data derived from histone modifications or TFs (histone or TF). Next, bigwig files are generated with bamCoverage. Multiple normalization methods can be chosen (RPKM, RPM, CPM, RPGC) or a spike-in count can be given (as soon as this is specified, no other normalization method is used). Furthermore, MACS2 is used to call peaks. This often requires additional parameters to be set, such as --nomodel flag, shiftsize, extension size and p value (https://github.com/macs3-project/MACS). If the histone modification is known to have broad peaks, please specify this as well. Finally the output from MACS2 is taken to annotate peaks with HOMER which requires genome files in formats GTF and FASTA (most important ones can be downloaded from GENCODE). Additionally, there is the possibility to compute GC bias with deeptools, visualize it and correct bam files by downsampling for GC bias. Then, downstream steps are made with the modified bam files. However, this option needs much more computing time! Because the workflow is easier and clearer without GC bias computation, a workflow script without this option was added.
